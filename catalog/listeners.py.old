import logging
logger = logging.getLogger("default")

from django.db.models.signals import post_delete
from django.db.models.signals import post_save
from django.db.models.signals import m2m_changed

from .models import Product
from .models import ProductPropertyRelation
from .models import ProductPropertyValue

def on_delete_relation(sender, **kwargs):
    logger.debug("on_delete_relation(%s, %s)", sender, instance)
    Product.objects.on_m2m_change(None, sender)

def on_save_relation(sender, **kwargs):
    logger.debug("on_save_relation(%s, %s)", sender, instance)
    Product.objects.on_m2m_change(None, sender)

post_delete.connect(on_delete_relation, sender=ProductPropertyRelation)
post_delete.connect(on_delete_relation, sender=ProductPropertyValue)
post_save.connect(on_save_relation, sender=ProductPropertyRelation)
post_save.connect(on_save_relation, sender=ProductPropertyValue)
